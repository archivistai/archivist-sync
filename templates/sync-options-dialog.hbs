<div class="archivist-sync-content">
  <!-- Tab Navigation -->
  <nav class="tabs" data-group="main">
    <a class="item" data-tab="world">
      <i class="fas fa-globe"></i>
      {{localize "ARCHIVIST_SYNC.tabs.world"}}
    </a>
    <a class="item" data-tab="title">
      <i class="fas fa-edit"></i>
      {{localize "ARCHIVIST_SYNC.tabs.title"}}
    </a>
    <a class="item" data-tab="characters">
      <i class="fas fa-users"></i>
      {{localize "ARCHIVIST_SYNC.tabs.characters"}}
    </a>
  </nav>

  <!-- Tab Content -->
  <div class="tab-content">
    <!-- World Selection Tab -->
    <div class="tab" data-tab="world">
      <div class="form-group">
        <label>{{localize "ARCHIVIST_SYNC.labels.apiStatus"}}</label>
        <div class="api-status">
          {{#if isApiConfigured}}
          <span class="status-indicator connected">
            <i class="fas fa-check-circle"></i>
            {{localize "ARCHIVIST_SYNC.status.connected"}}
          </span>
          <small>{{localize "ARCHIVIST_SYNC.labels.apiKey"}}: {{apiKey}}</small>
          {{else}}
          <span class="status-indicator disconnected">
            <i class="fas fa-times-circle"></i>
            {{localize "ARCHIVIST_SYNC.status.notConfigured"}}
          </span>
          <small>{{localize "ARCHIVIST_SYNC.hints.configureApi"}}</small>
          {{/if}}
        </div>
      </div>

      {{#if isApiConfigured}}
      <div class="form-group">
        <button type="button" class="sync-worlds-btn" {{#if isLoading}}disabled{{/if}}>
          {{#if isLoading}}
          <i class="fas fa-spinner fa-spin"></i>
          {{localize "ARCHIVIST_SYNC.buttons.syncing"}}
          {{else}}
          <i class="fas fa-sync"></i>
          {{localize "ARCHIVIST_SYNC.buttons.syncWorlds"}}
          {{/if}}
        </button>
      </div>

      {{#if worlds.length}}
      <div class="form-group">
        <label for="world-select">{{localize "ARCHIVIST_SYNC.labels.selectWorld"}}</label>
        <select id="world-select" name="worldSelect">
          <option value="">{{localize "ARCHIVIST_SYNC.options.selectWorld"}}</option>
          {{#each worlds}}
          <option value="{{this.id}}" {{#if (eq this.id ../selectedWorldId)}}selected{{/if}}>
            {{this.name}}
          </option>
          {{/each}}
        </select>
      </div>

      <div class="form-group">
        <button type="button" class="save-selection-btn" id="save-selection" disabled>
          <i class="fas fa-save"></i>
          {{localize "ARCHIVIST_SYNC.buttons.saveSelection"}}
        </button>
      </div>
      {{/if}}

      {{#if isWorldSelected}}
      <div class="current-selection">
        <h4>{{localize "ARCHIVIST_SYNC.labels.currentSelection"}}</h4>
        <p><strong>{{selectedWorldName}}</strong> (ID: {{selectedWorldId}})</p>
      </div>
      {{/if}}
      {{/if}}
    </div>

    <!-- Title Sync Tab -->
    <div class="tab" data-tab="title">
      {{#if isWorldSelected}}
      <div class="sync-section">
        <h4>{{localize "ARCHIVIST_SYNC.labels.foundryWorld"}}</h4>
        <div class="world-info">
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.title"}}:</strong> {{foundryWorldTitle}}</p>
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.description"}}:</strong> {{foundryWorldDescription}}</p>
        </div>
      </div>

      <div class="sync-section">
        <h4>{{localize "ARCHIVIST_SYNC.labels.archivistWorld"}}</h4>
        {{#if selectedWorldData}}
        <div class="world-info">
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.title"}}:</strong> {{selectedWorldData.title}}</p>
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.description"}}:</strong> {{selectedWorldData.description}}</p>
          {{#if selectedWorldData.lastUpdated}}
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.lastUpdated"}}:</strong> {{selectedWorldData.lastUpdated}}</p>
          {{/if}}
          {{#if selectedWorldData.createdAt}}
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.createdAt"}}:</strong> {{selectedWorldData.createdAt}}</p>
          {{/if}}
          {{#if selectedWorldData.characterCount}}
          <p><strong>{{localize "ARCHIVIST_SYNC.labels.characterCount"}}:</strong> {{selectedWorldData.characterCount}}
          </p>
          {{/if}}
        </div>
        {{else}}
        <div class="info">
          <p>{{localize "ARCHIVIST_SYNC.messages.loadingWorldData"}}</p>
        </div>
        {{/if}}
      </div>

      <div class="sync-section">
        <h4>{{localize "ARCHIVIST_SYNC.labels.syncTarget"}}</h4>
        <p><strong>{{selectedWorldName}}</strong> ({{selectedWorldId}})</p>
      </div>

      <div class="form-group">
        <button type="button" class="sync-title-btn" {{#if syncInProgress}}disabled{{/if}}>
          {{#if syncInProgress}}
          <i class="fas fa-spinner fa-spin"></i>
          {{localize "ARCHIVIST_SYNC.buttons.syncing"}}
          {{else}}
          <i class="fas fa-sync"></i>
          {{localize "ARCHIVIST_SYNC.buttons.syncTitle"}}
          {{/if}}
        </button>
      </div>
      {{else}}
      <div class="warning-message">
        <i class="fas fa-exclamation-triangle"></i>
        <p>{{localize "ARCHIVIST_SYNC.warnings.selectWorldFirst"}}</p>
      </div>
      {{/if}}
    </div>

    <!-- Character Mapping Tab -->
    <div class="tab" data-tab="characters">
      {{#if isWorldSelected}}
      <div class="characters-section">
        <h4>{{localize "ARCHIVIST_SYNC.labels.charactersAndNpcs"}}</h4>
        {{#if actors.length}}
        <div class="actors-list">
          {{#each actors}}
          <div class="actor-item">
            <div class="actor-info">
              <img src="{{this.img}}" alt="{{this.name}}" class="actor-avatar">
              <div class="actor-details">
                <h5>{{this.name}}</h5>
                <p class="actor-type">{{this.type}}</p>
              </div>
            </div>
            <div class="actor-actions">
              <button type="button" class="map-character-btn" data-actor-id="{{this.id}}">
                <i class="fas fa-link"></i>
                {{localize "ARCHIVIST_SYNC.buttons.map"}}
              </button>
            </div>
          </div>
          {{/each}}
        </div>

        <div class="form-group bulk-actions">
          <button type="button" class="sync-characters-btn" {{#if syncInProgress}}disabled{{/if}}>
            {{#if syncInProgress}}
            <i class="fas fa-spinner fa-spin"></i>
            {{localize "ARCHIVIST_SYNC.buttons.syncing"}}
            {{else}}
            <i class="fas fa-users"></i>
            {{localize "ARCHIVIST_SYNC.buttons.syncCharacters"}}
            {{/if}}
          </button>
        </div>
        {{else}}
        <p class="no-actors">{{localize "ARCHIVIST_SYNC.messages.noActors"}}</p>
        {{/if}}
      </div>
      {{else}}
      <div class="warning-message">
        <i class="fas fa-exclamation-triangle"></i>
        <p>{{localize "ARCHIVIST_SYNC.warnings.selectWorldFirst"}}</p>
      </div>
      {{/if}}
    </div>
  </div>
</div>